<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2025大机司机线上考试题库（全文本完整版）</title>
    <style>
        :root {
            --primary: #2563EB;
            --success: #16A34A;
            --error: #DC2626;
            --bg: #F1F5F9;
            --card: #FFFFFF;
            --text: #1E293B;
        }
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; }
        
        /* 顶部导航 */
        .header { background: var(--card); padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 2px rgba(0,0,0,0.05); z-index: 10; flex-shrink: 0; }
        .header h1 { font-size: 16px; font-weight: 700; margin: 0; color: #0F172A; }
        .progress { background: #EFF6FF; color: var(--primary); padding: 4px 12px; border-radius: 16px; font-size: 14px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 4px; }
        
        /* 题目区域 */
        .main { flex: 1; overflow-y: auto; padding: 16px; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 700px; }
        
        .card { background: var(--card); border-radius: 12px; padding: 20px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 20px; }
        
        .meta { display: flex; align-items: center; gap: 8px; margin-bottom: 16px; }
        .tag { padding: 4px 8px; border-radius: 4px; color: white; font-size: 12px; font-weight: bold; }
        .tag.single { background: var(--primary); }
        .tag.multi { background: #9333EA; }
        .tag.judge { background: #EA580C; }
        .q-id { color: #64748B; font-size: 14px; }
        
        .question { font-size: 17px; line-height: 1.6; font-weight: 600; margin-bottom: 24px; text-align: justify; white-space: pre-wrap; }
        
        /* 选项列表 */
        .options { display: flex; flex-direction: column; gap: 12px; }
        .opt { display: flex; align-items: flex-start; padding: 14px; border: 1.5px solid #E2E8F0; border-radius: 10px; cursor: pointer; transition: all 0.2s; background: #fff; }
        .opt:active { background: #F8FAFC; }
        
        .opt-key { width: 28px; height: 28px; border-radius: 50%; background: #F1F5F9; color: #64748B; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px; margin-right: 12px; flex-shrink: 0; border: 1px solid #CBD5E1; }
        .opt-text { font-size: 15px; line-height: 1.5; padding-top: 2px; }

        /* 状态样式 */
        .opt.correct { background: #F0FDF4; border-color: var(--success); }
        .opt.correct .opt-key { background: var(--success); color: white; border-color: var(--success); }
        
        .opt.wrong { background: #FEF2F2; border-color: var(--error); }
        .opt.wrong .opt-key { background: var(--error); color: white; border-color: var(--error); }
        
        .opt.selected { background: #EFF6FF; border-color: var(--primary); }
        .opt.selected .opt-key { background: var(--primary); color: white; border-color: var(--primary); }

        /* 底部解析和按钮 */
        .analysis { margin-top: 20px; padding: 16px; background: #F8FAFC; border-radius: 8px; border-left: 4px solid var(--primary); display: none; }
        .analysis.show { display: block; animation: slideDown 0.3s; }
        
        .btn-submit { width: 100%; padding: 14px; background: var(--primary); color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; margin-top: 20px; display: none; cursor: pointer; }

        /* 底部导航栏 */
        .footer { background: var(--card); padding: 12px 16px; border-top: 1px solid #E2E8F0; display: flex; gap: 12px; flex-shrink: 0; }
        .nav-btn { flex: 1; padding: 12px; border: none; border-radius: 8px; font-weight: 600; font-size: 15px; cursor: pointer; }
        .prev { background: #F1F5F9; color: #475569; }
        .next { background: var(--primary); color: white; }

        /* 答题卡弹窗 */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 100; }
        .modal-content { position: absolute; bottom: 0; left: 0; width: 100%; background: white; border-radius: 16px 16px 0 0; padding: 20px; max-height: 80vh; overflow-y: auto; display: flex; flex-direction: column; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(45px, 1fr)); gap: 10px; margin-top: 15px; }
        .grid-item { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; border-radius: 8px; background: #F1F5F9; color: #64748B; font-weight: 600; font-size: 13px; cursor: pointer; }
        .grid-item.ok { background: var(--success); color: white; }
        .grid-item.err { background: var(--error); color: white; }
        .grid-item.curr { outline: 2px solid var(--primary); outline-offset: 2px; }

        @keyframes slideDown { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="header">
    <h1>大机司机考试题库(完整版)</h1>
    <div class="progress" onclick="toggleSheet()">
        <span id="curNum">1</span>/<span id="totalNum">208</span> ☰
    </div>
</div>

<div class="main">
    <div class="container">
        <div class="card">
            <div class="meta">
                <span class="tag single" id="qTag">单选</span>
                <span class="q-id">第 <span id="qIdx">1</span> 题</span>
            </div>
            <div class="question" id="qText">题目加载中...</div>
            <div class="options" id="optBox"></div>
            
            <button class="btn-submit" id="subBtn" onclick="submitMulti()">提交答案</button>

            <div class="analysis" id="analysis">
                <div style="font-size:13px;color:#64748B;margin-bottom:4px">正确答案</div>
                <div style="font-size:18px;font-weight:bold;color:var(--primary)" id="rightAns"></div>
            </div>
        </div>
    </div>
</div>

<div class="footer">
    <button class="nav-btn prev" onclick="changeQ(-1)">上一题</button>
    <button class="nav-btn next" onclick="changeQ(1)">下一题</button>
</div>

<div class="modal" id="sheetModal" onclick="toggleSheet()">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div style="display:flex;justify-content:space-between;align-items:center">
            <h3>答题卡</h3>
            <span onclick="toggleSheet()" style="padding:10px;font-size:24px;color:#94A3B8">&times;</span>
        </div>
        <div class="grid" id="sheetBox"></div>
    </div>
</div>

<script>
// 完整题库数据：严格对照PDF录入，包含所有长难句
const db = [
    // --- Page 1 ---
    {t:1, q:"1. 滤油器的进、出口压差随着滤芯的堵塞而（ ）。", o:["减小","不变","增大","不变或增大"], a:"C"},
    {t:1, q:"2. 直接选配法的装配质量在很大程度上取决于（ ）。", o:["零件的加工精度","工人的技术水平","生产的批量","装配的工具"], a:"B"},
    {t:1, q:"3. 柴油发动机活塞环不是一个整圆环，而是呈开口状，在自由状态下的直径（ ）气缸直径。", o:["大于","等于","小于","等于或大于"], a:"A"},
    {t:1, q:"4. 柴油发动机的主要运动几件是（ ）。", o:["起动系统","机体组件","气门挺杆","曲柄连杆机构"], a:"D"},
    {t:1, q:"5. 四冲程V型六缸发动机的发火间隔角为（ ）。", o:["60","80","120","180"], a:"C"},
    {t:1, q:"6. 发动机的压缩比是指（ ）。", o:["发动机排量与燃烧室容积","气缸工作容积与燃烧室容积","气缸总容积与燃烧室容积","气缸总容积与气缸工作容积"], a:"C"},
    {t:1, q:"7. 在冷却系中，（ ）的作用是控制流经散热器的水量的元件。", o:["节温器","水泵","旁通阀","水箱"], a:"A"},
    {t:1, q:"8. 发动机的气缸壁采用（ ）。", o:["润滑脂润滑","压力润滑","飞溅润滑","油泵润滑"], a:"C"},
    {t:1, q:"9. 发动机中，活塞与连杆之间的活塞销主要起（ ）。", o:["定位作用","联接作用","保护作用","防松作用"], a:"B"},
    {t:1, q:"10. 发动机进、排气门在排气上止点时（ ）。", o:["进气门开、排气门关","进、排气门全关","进、排气门全开","进、排气门叠开"], a:"D"},
    {t:1, q:"11. 采用可变配气相位的目的是（ ）。", o:["提高进气时间","提高充气效率","便于排气","减少污染"], a:"B"},
    {t:1, q:"12. 扭振减震器有多种形式，如橡胶阻尼减振器、液力阻尼减振器、橡胶─液力负荷减振器、共振式减振器等。道依茨风冷柴油发动机采用（ ）减振器。", o:["液力阻尼减振器","橡胶阻尼减振器","橡胶─液力负荷减振器","共振式减振器"], a:"B"},
    {t:1, q:"13. 发动机排量是指发动机各气缸（ ）的总和。", o:["工作容积","燃烧室容积","总容积","浮子室容积"], a:"A"},
    {t:1, q:"14. 发动机进气门晚关的目的是（ ）。", o:["减少进气阻力","排气更容易","减少进气量","充分利用气流的惯性，增加进气量"], a:"D"},
    {t:1, q:"15. 造成机油压力过低的主要原因是供给主油道量（ ），或是主油道以后的油路有漏油现象。", o:["不变","增多","减少","减少或不变"], a:"C"},

    // --- Page 2 ---
    {t:1, q:"1. 《铁路交通事故应急救援和调查处理条例》是由哪个部门发布的？", o:["中华人民共和国铁道部","中华人民共和国国务院","国家安全生产监督管理总局","中华人民共和国交通运输部"], a:"B"},
    {t:1, q:"2. 《铁路交通事故应急救援和调查处理条例》自何时起施行？", o:["2007年6月27日","2007年7月1日","2007年7月11日","2007年9月1日"], a:"B"},
    {t:1, q:"3. 造成多少人以上死亡的铁路交通事故属于特别重大事故？", o:["10人","20人","30人","50人"], a:"C"},
    {t:1, q:"4. 繁忙干线客运列车脱轨多少辆以上并中断铁路行车48小时以上的属于特别重大事故？", o:["10辆","15辆","18辆","20辆"], a:"C"},
    {t:1, q:"5. 铁路管理机构接到事故报告后，对于特别重大事故、重大事故，应立即报告给哪个部门？", o:["事故发生地县级以上地方人民政府","国务院铁路主管部门","国家安全生产监督管理总局","公安机关"], a:"B"},
    {t:1, q:"6. 事故报告内容不包括以下哪项？", o:["事故发生的时间、地点、区间","事故发生地的天气情况","人员伤亡情况，机车车辆等损坏情况","事故原因的初步判断"], a:"B"},
    {t:1, q:"7. 特别重大事故的调查期限为多少天？", o:["10日","20日","30日","60日"], a:"D"},
    {t:1, q:"8. 事故认定书制作完成后，组织事故调查组的机关或者铁路管理机构应在多少日内送达相关单位？", o:["7日","10日","15日","30日"], a:"C"},
    {t:1, q:"9. 因不可抗力造成的铁路交通事故，应定为（ ）", o:["责任事故","非责任事故","待定事故","以上都不对"], a:"B"},
    {t:1, q:"10. 铁路作业人员在从事与行车相关的作业过程中，因违反操作规程造成伤亡，应定为（ ）", o:["责任事故","非责任事故","待定事故","以上都不对"], a:"A"},
    {t:1, q:"11. 下列哪项费用不属于事故直接经济损失？", o:["铁路设备设施的损失费用","事故应急处置和救援费用","事故间接导致的企业停产损失","事故中受伤人员的医治费用"], a:"C"},
    {t:1, q:"12. 负有事故全部责任的单位，应承担事故直接经济损失费用的比例是（ ）", o:["30%以下","30%-50%","50%以上","100%"], a:"D"},
    {t:1, q:"13. 每日事故的统计时间范围是（ ）", o:["上一日0时至当日0时","上一日6时至当日6时","上一日12时至当日12时","上一日18时至当日18时"], a:"D"},

    // --- Page 3 (用户指出有缺漏的页面) ---
    {t:1, q:"14. 一起事故同时符合两个以上事故等级的，应按哪个等级进行统计？", o:["较低事故等级","较高事故等级","平均事故等级","任意一个等级"], a:"B"},
    {t:1, q:"15. 《铁路交通事故调查处理规则》自何时起施行？", o:["2007年7月1日","2007年8月19日","2007年8月28日","2007年9月1日"], a:"D"},
    {t:1, q:"1. 在显示停车信号的信号机前，必须果断停车，停车后列车管减压量不得少于（ ）。", o:["80kPa","60kPa","120kPa","100kPa"], a:"D"},
    {t:1, q:"2. 严格执行运行揭示调度命令“接收、编辑、（ ）、传递、导入”制度，确保运行揭示调度命令准确无误，GYK导入（输入）数据有效，准确控制运行速度。", o:["核对","确认","互控","登记"], a:"A"},
    {t:1, q:"3. 整列制动机试验时，本务司机与尾部司机必须注意核对风压、（ ），认真检查列车制动主管压力的变化情况，确保全列贯通良好。", o:["充排风时间","总风缸风压","列车管压力","制动力"], a:"A"},
    {t:1, q:"4. 列车在区间被迫停车不能继续运行时，应立即使用列车无线调度通信设备通知( )（列车调度员），报告停车原因和停车位置。", o:["前方车站","后方车站","段调度","两端站值班员"], a:"D"},
    // 修正：补全调谐区题目的完整文本
    {t:1, q:"5. 在自动闭塞区间运行时不准停在调谐区内。因紧急制动停车或被迫停在调谐区内时，须立即通知后续列车、向两端站值班员（列车调度员）报告停车位置（具备移动条件时司机须先将车辆移动不少于（ ）米。", o:["60","80","20","180"], a:"C"},
    {t:1, q:"6. 运行中使用紧急制动阀停车后再开车时，司机须检查制动主管的贯通状态（本务司机确认制动主管压力达到规定压力后，操作自动制动阀减压（ ）kpa，补机司机确认发生制动作用）。", o:["80","100","50","120"], a:"C"},
    // 修正：补全宿营车题目的完整文本
    {t:1, q:"7. 宿营车、供电车、餐车、卫生车、工具车等附属车辆在车站或专用线停留过夜时，除设置防溜铁鞋、拧紧两端人力制动机外，还须在距离停留车辆不超（ ）m处设置防溜枕木。。", o:["5","10","6","2"], a:"A"},
    {t:1, q:"8. 单车作业，司机须确认自阀最大减压量，单阀全制位，制动缸压力（ ）KPa以上方可进行换端作业，。", o:["200","150","300","100"], a:"C"},
    {t:1, q:"9. 司机出勤时应认真核对运行揭示，重点掌握( )级防洪地段位置、联控用语等关键内容。。", o:["Ⅱ","Ⅰ、Ⅱ","Ⅰ","所有"], a:"B"},
    {t:1, q:"10. 运行中牵引通过“鱼背形”坡道时，本务车越过变坡点后应缓慢地( )牵引力。", o:["消除","控制","加大","减小"], a:"D"},
    // 修正：补全施工预备会题目的完整文本
    {t:1, q:"11. 施工预备会，应明确机械车的作业任务、施工地点、封锁区间、计划封锁时间、运行和作业安全措施、施工负责人联系方式等内容，并提前以( )形式通知到司机。", o:["口头","书面","会议","网络"], a:"B"},
    {t:1, q:"12. 施工中，司机必须掌握( )变化情况，确保施工期间行车安全。", o:["线路设备","行车设备","信号","车辆"], a:"B"},

    // --- Page 4 ---
    {t:1, q:"13. 进入长大下坡道前，本务车司机应择机进行制动机贯通试验，列车制动主管减压量不小于( )kPa，车列速度下降3～5km/h后缓解，确认制动性能良好。", o:["50","100","80","60"], a:"A"},
    {t:1, q:"14. 机械车上高速铁路运行时，运用单位须指派或( )以上人员进行盯控。", o:["工长","副段","主任","副主任"], a:"D"},
    {t:1, q:"15. 多线并行地段，发车前正、副司机应双人确认（ ）灯位显示", o:["出站","进路","发车进路表示器","调车"], a:"C"},
    {t:1, q:"1. YZ-1型空气制动机缓解时，均衡风缸压力自0充至480kPa的时间为（ ）s。", o:["2～4","5～7","8～10","10～15"], a:"B"},
    {t:1, q:"2. YZ-1型空气制动机的自动制动阀在（ ）时，均衡风缸的压力空气经由自动制动阀通大气，使均衡风缸压力下降。", o:["制动位","缓解位","保压位","运转位"], a:"A"},
    {t:1, q:"3. 下压大闸手柄，可以将（ ）的压力空气排向大气。", o:["作用管","容积室","单缓管","工作风缸管"], a:"C"},
    {t:1, q:"4. 下压小闸手柄，可以将（ ）的压力空气排向大气。", o:["作用管","容积室","单缓管","总风管"], a:"A"},
    {t:1, q:"5. YZ-1 型空气制动机的单独制动阀实际上只有3个作用位置，即缓解位、中立位与（ ）。", o:["运转位","保压位","制动位","单缓位"], a:"C"},
    {t:1, q:"6. YZ-1型空气制动机的总风遮断阀受（ ）的控制，用以开闭中继阀的总风源。", o:["电空阀","分配阀","紧急放风阀","中继阀"], a:"A"},
    {t:1, q:"7. 根据（ ）的压力变化，双阀口式中继阀共有3个作用位置。", o:["制动主管","均衡风缸","总风管","总风缸"], a:"B"},
    {t:1, q:"8. 大型养路机械制动系统中，中继阀的作用是直接控制（ ）的压力变化的装置。", o:["制动主管","制动缸","均衡风缸管","列车管"], a:"A"},
    {t:1, q:"9. 大闸手柄在缓解位或运转位时，由于（ ）失电，中继阀中的总风遮断阀处于开启状态，所以制动主管压力泄漏可以得到补充。", o:["单独制动阀","自动制动阀","电空阀","电磁阀"], a:"C"},
    {t:1, q:"10. 109分配阀处于制动保压位时,制动缸及其连接管系发生泄漏后，制动缸压力将 （ ）。", o:["下降","上升","保持不变","一会下降一会上升"], a:"C"},
    {t:1, q:"11. JZ-7型空气制动机在调整制动缸最高压力时，单阀手柄应置于（ ） 。", o:["单独缓解位","运转位","全制动位","单独作用位"], a:"C"},

    // --- Page 5 ---
    {t:1, q:"12. DC-32k捣固车规定的闸瓦间隙为（ ）mm。", o:["5～10","11～16","17～20","19～21"], a:"A"},
    {t:1, q:"13. 转向架上的基础制动装置，可以将制动缸活塞产生的制动原力（ ） 。", o:["放大","减小","保持不变","不变"], a:"A"},
    {t:1, q:"14. （ ）不能产生制动原力。", o:["空气制动机","手制动机","基础制动装置","止轮器"], a:"C"},
    {t:1, q:"15. DC-32k捣固车制动缸活塞最大有效行程为（ ）mm。", o:["30","50","120","180"], a:"C"},
    {t:1, q:"1. 为保护蓄电池，每次起动不超过（ ）S，两次起动应间隔2分钟，三次起动不着须排除故障后再起动；", o:["3","4","5","9"], a:"C"},
    {t:1, q:"2. 控制启动马达继电器的线号是（ ）", o:["206","208","313","314"], a:"A"},
    {t:1, q:"3. 末级离合继电器自保回路供电的线号是（ ）", o:["206","208","243","215"], a:"B"},
    {t:1, q:"4. DC---32、DCL---32给监测回路供电的是( ).", o:["A43","A26","201","204"], a:"A"},
    {t:1, q:"5. 08-32捣固车变矩器的报警电路监视着( )个信号", o:["2","3","4","5"], a:"B"},
    {t:1, q:"6. 在测量液力机械变速箱的油位时,机油温度在80C时,油位高度应达到标尺刻度的（）限。", o:["上","中","下","点"], a:"A"},
    {t:1, q:"7. 测量轮对内侧距，应满足( )mm", o:["1353±1","1353±2","1353±3","1353±4"], a:"C"},
    {t:1, q:"8. “润滑油换新”是在齿轮箱（）检修内容中的规定。", o:["4","3","2","1"], a:"B"},
    {t:1, q:"9. 线路维修捣固作业捣固时应设置不少于（ ）MM的基本起道量", o:["10","20","30","50"], a:"A"},
    {t:1, q:"10. 《大型养路机械修程修制管理规定》修程管理中，大机检修实行 ()级修程。", o:["1","5","30","4"], a:"B"},

    // --- Page 6 ---
    {t:1, q:"11. 加注柴油时，必须经装有()目滤芯的过滤器过滤", o:["200","100","300","50"], a:"A"},
    {t:1, q:"12. 道岔维修捣固作业范围包括岔区及其前后各（ ）M的线路，一次起道量应控制在10～50 mm，拨道量不超过20 mm，接头、辙叉、尖轨曲向可弯部位增加捣固次数", o:["20","30","","50"], a:"D"},
    {t:1, q:"13. 捣固车一次起道量不宜超过50mm，起道量超过50mm应分两次起道捣固；一次拨道量不宜超过（）", o:["80","120","150","200"], a:"A"},
    {t:1, q:"14. 大型养路机械运用中车钩高度调整的一般方法是在（ ）下和钩尾框托板内加调整垫。", o:["钩身磨耗板","缓冲器","钩尾框","钩舌"], a:"A"},
    {t:1, q:"15. 二级修对电气系统、液压系统、气动系统、车钩缓冲装置、空调系统、车体结构等每6个月进行一次，可根据检修条件适当延长，但延长不得超过（）日。", o:["15","30","40","60"], a:"A"},
    {t:1, q:"16. 车间成立志愿消防队，队员不得少于本车间人数的（ ）。", o:["0.1","0.15","0.2","0.25"], a:"C"},
    {t:1, q:"17. 车间要建立健全消防安全教育培训制度，对本车间的消防安全责任人、专（兼）职消防管理人员，电工、电气焊、发电司机等特种作业人员，仓库管理员、轨道车乘务员、大型机械操作员等重点岗位人员，（ ）至少一次。", o:["每年","每季","每月","每日"], a:"A"},
    {t:1, q:"18. 车间要根据施工生产实际，适时开展消防演练；至少每年进行（ ）消防演练，工程宿营车所属车间至少每半年进行一次消防应急逃生演练，以提高广大干部职工的火灾应急处置和逃生技能。", o:["四次","三次","两次","一次"], a:"D"},
    {t:1, q:"19. 手提贮压式干粉灭火器的报废年限为（）年", o:["12","10","8","6"], a:"B"},
    {t:1, q:"20. 《建筑灭火器配置验收与检查规范》GB50444-2008第5.3.2条规定，水基型灭火器：出厂期满（）年开始维修，首次维修以后每满1年。", o:["1","2","3","4"], a:"C"},
    {t:1, q:"21. 禁止在工程宿营车、工务机械车、物资存放场所、检修库、生产库、档案楼等重点场所内（）和使用明火。在施工作业时，应严格野外用火、吸烟管理。", o:["坐卧","玩耍","动火","吸烟"], a:"D"},
    {t:1, q:"22. 机组加注燃油时，必须有一名车间（）以上人员盯控加油作业全过程。", o:["工班长","机长","业务主管","副主任"], a:"D"},
    {t:1, q:"23. 具有火灾、爆炸危险的场所应设置明显的警示标志，禁止吸烟、使用（ ）。", o:["器械","明火","油料","氧气"], a:"B"},
    {t:1, q:"24. 工班长对所属工程宿营车（ ）不少于一次消防检查；", o:["每年","每季","每月","每周"], a:"D"},

    // --- Page 7 ---
    {t:1, q:"25. 非施工期间，工程宿营车在基地及段管线停留时，按照车辆封存相关规定，切断全车电源，关闭车窗、锁闭车门、张贴封条。安排专人不超过（）小时对停留工程宿营车进行一次巡视检查,按要求填写 “防火防溜二维", o:["A4","B6","C12","D24"], a:"C"},
    {t:2, q:"1. 安全疏散设施包括（ ）、（ ）、疏散楼梯、（ ）、（ ）等设施，以及消防过滤式自救呼吸器、逃生缓降器等安全疏散辅助器材。", o:["疏散门","疏散走道","消防应急照明","疏散指示标志"], a:"ABCD"},
    {t:2, q:"2. 消防安全“四懂”包括哪些内容？（）（）（）（）", o:["懂火灾的危险性","懂预防火灾的基本知识","懂扑救火灾的方法","懂疏散逃生的方法"], a:"ABCD"},
    {t:2, q:"3. 消防安全“四会”包括哪些内容？（）（）（）（）", o:["会报火警","会使用消防器材","会扑救初起火灾","会自救逃生"], a:"ABCD"},
    {t:2, q:"4. 消防安全知识培训教育内容应当包括：", o:["有关消防法规、消防安全制度","本车间、本岗位的火灾危险性","有关消防设施器材的性能及使用","报火警、扑救初起火灾以及自救"], a:"ABCD"},
    {t:2, q:"5. 段属各基地、车辆停留场所线路及两侧，物资存放场所的（ )、（ ）、可燃包装，使用过的（ ）、（ ）、沾油纤维物品等可燃材料，应当及时清理。", o:["枯草","可燃垃圾","油棉纱","油手套"], a:"ABCD"},
    {t:1, q:"1. 非正常行车模式下具有地面信号确认﹑（ ）﹑路票行车、引导进站﹑调度命令发车等五种非正常行车状态.非正常行车选择界面", o:["区间地面信号确认","红色许可证","绿色许可证行车","运行揭示限速"], a:"C"},
    {t:1, q:"2. 选择“绿色许可证”，输入调度命令号、（ ）", o:["绿色许可证编号","限速速度","限速里程","绿色许可证关键信息"], a:"A"},
    {t:1, q:"3. 使用绿色许可证模式后，按压【解锁】+【确认】键，装置解除本架信号机的停车控制，按道岔限速运行，在前方（ ）之后重新生成常用制动停车曲线", o:["1400","700m","200","1600"], a:"B"},
    {t:1, q:"4. 一切电话中断后，连续发出同一方向的列车时，两列车的间隔时间，应按区间规定的运行时间另加（），但不得少于（）", o:["3 min、13 min","4 min、13 min","3 min、14 min","5 min、15 min"], a:"A"},
    {t:1, q:"5. 使用红色许可证发车前，双线按时间间隔法行车时，只准发出正方向的列车。非自动闭塞区间发出第一个列车时，在发车前应查明区间已（）", o:["列车位置","空闲","占用情况","占用"], a:"B"},
    {t:1, q:"6. 遇引导进站手信号，运行速度小于（）时", o:["20km/h","15km/h","30km/h","25km/h"], a:"A"},
    {t:1, q:"7. 遇天气恶劣，信号机显示距离不足（ ）时，司机或车站值班员须立即报告列车调度员", o:["800m","400m","200m","1200m"], a:"C"},
    {t:1, q:"8. 红色许可证（ ）使用", o:["两架以上信号机故障","电话中断时的行车","基本闭塞行车法出现问题","特殊情况下"], a:"B"},

    // --- Page 8 ---
    {t:1, q:"9. 取得红色许可证后。应采取最快的方法传送，优先方向车站如无开往区间的列车时，在确认区间空闲后，可使用（ ）车或单机传送。", o:["重型轨道","轨道车","大型养路机械设备","途径所有列车"], a:"A"},
    {t:1, q:"10. 脱离驾驶岗位（ ）个月及以上的司机持有效的《铁路机车车辆驾驶证》» 或 «理论考试合格证明» 、经运用单位组织培训且考试合格后方可重返驾驶岗位", o:["1","3","6","9"], a:"B"},
    {t:1, q:"11. 轨道作业车应安装作业（）系统、 轴温监测装置等行车安全设备发挥其在事故故障预防及分析中的作用。", o:["视频安全监控","GYK","GYK、CIR","GMS"], a:"A"},
    {t:1, q:"12. 轨道作业车上线运行前应合理编组保证车组（）具有良好的瞭望条件司机应在运行方向的前端操纵轨道作业车", o:["运行端","补机段","本务端","操纵端"], a:"D"},
    {t:1, q:"13. 轨道作业车连挂运行时本务司机与补机司机应保持联系确保各提供动力的补机司机与本务司机（ )操纵.", o:["同步","一致","同时","一同"], a:"A"},
    {t:1, q:"14. 规范施工组织方案编制明确作业内容和要求将轨道作业车调车转线、运行径路、 （ ）、 解列连挂等纳入施工组织方案", o:["停车地点","防护地点","特殊信号机位置","站界"], a:"A"},
    {t:1, q:"15. 施工预备会应明确轨道作业车的作业任务、 施工地点、 封锁区间、（）、 运行作业安全措施等内容并提前以书面式通知到司机", o:["计划封锁时间","施工任务量","准备工作内容","安全关键项点"], a:"A"},
    
    // --- 判断题区域 (Page 8 - 13) ---
    {t:3, q:"1. 柴油发动机的工作冲程也叫膨胀冲程或爆发冲程。（ ）", o:["对","错"], a:"A"},
    {t:3, q:"2. 要提高机修装备精度，必须提高零件的加工精度。（ ）", o:["对","错"], a:"B"},
    {t:3, q:"3. 柴油发动机的燃烧过程是柴油机工作循环中起决定性作用的过程。（ ）", o:["对","错"], a:"A"},
    {t:3, q:"4. 主轴本身的精度，实际上就是主轴部件的精度。（ ）", o:["对","错"], a:"A"},
    {t:3, q:"5. 传动机构是将来自曲轴的动力传递给维持柴油发动机正常工作所需的各种附件。如配气机构、喷油泵、风扇、机油泵等，并驱动液压泵等辅助装置工作，为配套机械提供动力。( )", o:["对","错"], a:"A"},
    {t:3, q:"6. 柴油发动机气缸中进行的每一次将热能转变为机械能的一系列连续过程叫做一个工作循环（ ）。", o:["对","错"], a:"A"},
    {t:3, q:"7. 柴油发动机的每一工作循环都包括进气、压缩、作功或膨胀和排气四个冲程，这四个冲程是不断重复进行的（ ）。", o:["对","错"], a:"A"},
    {t:3, q:"8. 完成一个工作循环，活塞要连续运行四个冲程（曲轴旋转两周）的柴油发动机就叫四冲程柴油机（ ）。", o:["对","错"], a:"A"},

    // --- Page 9 ---
    {t:3, q:"9. 活塞上、下运行时，活塞离曲轴中心最大距离的位置称为上止点， 离曲轴中心最小距离的位置称为下止点，上、下止点，活塞的运动方向将得到改变，活塞的速度等于零（ ）。", o:["对","错"], a:"A"},
    {t:3, q:"10. 曲柄连杆机构主要由机体组、曲轴飞轮组和活塞连杆组三大部分组成（ ）。", o:["对","错"], a:"A"},
    {t:3, q:"11. 发动机排量是指发动机各气缸燃烧室容积的总和（ ）。", o:["对","错"], a:"B"},
    {t:3, q:"12. 凸轮轴上凸轮的轮廓的形状决定于气门的运动规律（ ）。", o:["对","错"], a:"A"},
    {t:3, q:"13. 发动机润滑系统是发动机重要的组成部分（ ）。", o:["对","错"], a:"A"},
    {t:3, q:"14. 发动机的机油压力传感器和机油压力表要相互匹配，更换新的机油压力传感器时不需要看好型号是否正确（ ）。", o:["对","错"], a:"B"},
    {t:3, q:"15. 在每天启动动发动机时不需要检查发动机机油（ ）。", o:["对","错"], a:"B"},
    {t:3, q:"1. 《铁路交通事故应急救援和调查处理条例》仅适用于铁路机车车辆在运行过程中发生的与行人、机动车相撞的事故。", o:["正确","错误"], a:"B"},
    {t:3, q:"2. 国务院铁路主管部门负责组织、指挥、协调铁路事故的应急救援和调查处理工作。", o:["正确","错误"], a:"A"},
    {t:3, q:"3. 造成50人以上100人以下重伤的铁路交通事故属于重大事故。", o:["正确","错误"], a:"A"},
    {t:3, q:"4. 事故报告后出现新情况的，无需补报。", o:["正确","错误"], a:"B"},
    {t:3, q:"5. 任何单位和个人可以根据救援需要破坏事故现场。", o:["正确","错误"], a:"B"},
    {t:3, q:"6. 较大事故和一般事故只能由事故发生地铁路管理机构组织事故调查组进行调查。", o:["正确","错误"], a:"B"},
    {t:3, q:"7. 事故调查报告形成后，报经组织事故调查组的机关或者铁路管理机构同意，事故调查组工作即告结束。", o:["正确","错误"], a:"A"},
    {t:3, q:"8. 事故认定书是事故赔偿、事故处理以及事故责任追究的依据。", o:["正确","错误"], a:"A"},
    {t:3, q:"9. 因产品质量不良造成事故，若属设计单位责任，定设计单位责任。", o:["正确","错误"], a:"A"},
    {t:3, q:"10. 作业人员因患有职业禁忌症而导致行为失控，造成伤亡的，不定责任。", o:["正确","错误"], a:"B"},
    {t:3, q:"11. 事故直接经济损失中包含人身保险赔偿费用。", o:["正确","错误"], a:"B"},
    {t:3, q:"12. 负同等责任的单位，承担相同比例的事故直接经济损失费用。", o:["正确","错误"], a:"A"},
    {t:3, q:"13. 事故受伤人员经救治无效，在7日后死亡的，按死亡统计。", o:["正确","错误"], a:"B"},
    {t:3, q:"14. 《铁路交通事故调查处理规则》废止了《铁路行车事故处理规则》等多部旧规。", o:["正确","错误"], a:"A"},
    {t:3, q:"15. 机车车辆断轴造成事故，由于货物超载造成的，定装车站或作业站责任。", o:["正确","错误"], a:"A"},
    {t:3, q:"1. 司机要听从施工负责人的指挥，在施工负责人下达动车指令后，司机要向施工负责人再次复述动车指令内容，进行二次核对，确认运行方向无误后方可动车。（ ）", o:["对","错"], a:"A"},

    // --- Page 10 ---
    {t:3, q:"2. 挂运时手动将GYK放风塞门关闭，防止放风自停。驾驶室内的制动机手柄必须取出并做好防误碰措施，防止误动作。（ ）", o:["对","错"], a:"A"},
    {t:3, q:"3. 挂运时，押运负责人应安排人员添乘机车，提前与机车司机联系并交代缓解等技术要求与安全注意事项；其中大型养路机械必须有1名是机长或副机长；每组宿营车配置随车检车人员（经车辆段培训合格的人员）不少", o:["对","错"], a:"A"},
    {t:3, q:"4. 运行中发现制动、走行部及与行车安全有关的总成、部件出现异常，必须立即停车检查处理，并及时汇报车站值班员或列车调度员。（ ）", o:["对","错"], a:"A"},
    {t:3, q:"5. 运用单位应对机械车易松脱部件进行画线标识，重点标识部位包括走行、传动、制动系统和转向架悬挂装置、作业装置、起重装置等安全关键部", o:["对","错"], a:"A"},
    {t:3, q:"6. 作业过程中，机械车制动系统出现故障或总风缸无法建压时，司机应立即对车辆设置防溜措施，同时通知施工负责人，及时安排就近施工车辆", o:["对","错"], a:"A"},
    {t:3, q:"7. 开车前各机械车应先行加载，再缓解各车的单独制动，然后本务车缓解整列制动机，本务车司机指挥其他提供动力的车辆同步操纵，防止车辆溜逸或空转。 ）。", o:["对","错"], a:"A"},
    {t:3, q:"8. 在长大下坡道停车后，司机不得离开操纵位置，必须实施保压制动，列车管减压不得低于100kpa，各机械车单独制动阀推至全制动位（ ）", o:["对","错"], a:"A"},
    {t:3, q:"9. 运行途中，司机应注意观察发动机的温度、机油压力、冷却水温，液力变矩器（变速箱）的油温、压力等参数。发现异常，应立即采取降低发动机转速或减缓措施；异常不能消除时，必须停车检查处理，待恢复正常后", o:["对","错"], a:"A"},
    {t:3, q:"10. 车辆进入长大下坡道前，速度应减至30km/h左右，遇雨、雪不良天气时，应将速度降至20km/h以下再行缓解（ ）。", o:["对","错"], a:"A"},
    {t:3, q:"11. 线路坡度超过6‰，长度为7km及以上是长大坡道（ ）。", o:["对","错"], a:"B"},
    {t:3, q:"12. 机械车开始分解作业前，GYK模式转为区间作业模式【区间防碰状态】，各车须保持10m以上安全距离（ ）。", o:["对","错"], a:"A"},
    {t:3, q:"13. 施工前，施工负责人应组织司乘人员召开班前预想会进行技术交底并录音、录像（ ）。", o:["对","错"], a:"A"},
    {t:3, q:"14. 横越线路时，严格执行“一停、二看、三通过”和“手比、眼看、口呼”制度。严禁在运行中的车辆前方抢越线路（ ）。", o:["对","错"], a:"A"},
    {t:3, q:"1. 用作大闸的空气制动阀在缓解位时，输出电信号。（ ）", o:["对","错"], a:"B"},
    {t:3, q:"2. 用作大闸的空气制动阀在运转位时，输出电信号。（ ）", o:["对","错"], a:"B"},
    {t:3, q:"3. 用作大闸的空气制动阀在保压位时，输出电信号。（ ）", o:["对","错"], a:"A"},
    {t:3, q:"4. 用作大闸的空气制动阀在制动位时，输出电信号。（ ）", o:["对","错"], a:"A"},
    {t:3, q:"5. YZ-I型空气制动机单独制动时全制动时间不大于4s，全缓解时间不大于5s。", o:["对","错"], a:"A"},
    {t:3, q:"6. YZ-1型空气制动机的空气制动阀转换柱塞处于电空位时作自动制动阀使", o:["对","错"], a:"B"},
    {t:3, q:"7. 当自动制动阀处在缓解位时，调压后的总风向均衡风缸充风，均衡风缸压力上升。（ ）", o:["对","错"], a:"A"},

    // --- Page 11 ---
    {t:3, q:"8. 当自动制动阀处在制动位时，均衡风缸的压力空气排入大气，均衡风缸压力下降。（ ）", o:["对","错"], a:"A"},
    {t:3, q:"9. YZ-1型空气制动机自动制动阀处于保压位时，制动主管压力泄漏可以得到补充。 （ ）", o:["对","错"], a:"B"},
    {t:3, q:"10. YZ-1型空气制动机制动主管的压力变化是通过均衡风缸的压力变化来控制的，而均衡风缸的压力变化是通过操纵自动制动阀来实现的。（", o:["对","错"], a:"A"},
    {t:3, q:"11. 中继阀由双阀口式中继阀、总风遮断阀和阀座3部分组成。（ ）", o:["对","错"], a:"A"},
    {t:3, q:"12. 总风遮断阀是专为开启或关闭向制动主管供风的总风通路而设的，它相当于控制中继阀向制动主管充风的一个阀门。（ ）", o:["对","错"], a:"A"},
    {t:3, q:"13. 调压阀既可以将总风缸的压力空气调低，也可以将总风缸的压力空气", o:["对","错"], a:"B"},
    {t:3, q:"14. YZ-1型空气制动机共设有多个调压阀，分别控制不同的管路，但它们所控制的压力相同。（ ）", o:["对","错"], a:"B"},
    {t:3, q:"15. YZ-1制动系统常采用104型分配阀。（ ）", o:["对","错"], a:"B"},
    {t:3, q:"1. 08-32捣固车故障报警信号灯点亮，同时启动一个时间继电器并产生声", o:["对","错"], a:"A"},
    {t:3, q:"2. 捣固车捣固装置升降控制系统是一个包括电路、液压部件和传感器组成的开环控制系统。", o:["对","错"], a:"B"},
    {t:3, q:"3. 对长时间停放的发动机在启动前，应按线刻度检查。", o:["对","错"], a:"B"},
    {t:3, q:"4. 发动机启动后机油压力的显示范围为 0.2-0.6MPA。", o:["对","错"], a:"A"},
    {t:3, q:"5. 制动压力开关实现对变矩器的联锁控制其压力值为0.28Mpa 。", o:["对","错"], a:"A"},
    {t:3, q:"6. 08-32捣固车对重型钢轨进行拨道作业时所产生的回弹问题可以通过超量拨道电路的控制来解决。", o:["对","错"], a:"A"},
    {t:3, q:"7. 08-32捣固车每块程控功率输出板上包括8路功率放大电路。", o:["对","错"], a:"B"},
    {t:3, q:"8. 08-32捣固车GVA有输入、修改、输出、测距、计算五种功能。", o:["对","错"], a:"B"},
    {t:3, q:"9. 08-32捣固车故障报警信号灯点亮，同时启动一个时间继电器并产生声", o:["对","错"], a:"A"},
    {t:3, q:"10. 08-32捣固车多路检测系统可以检测五组电源电压信号", o:["对","错"], a:"B"},
    {t:3, q:"11. 08-32捣固车2号输入输出板上的红灯亮时，功率输出板上对应的红灯", o:["对","错"], a:"B"},
    {t:3, q:"12. 08-32捣固车程控电路中，用了24个子程序信号，这些子程序信号都直接参与对机器作业部件的控制。", o:["对","错"], a:"B"},
    {t:3, q:"13. 08-32捣固车手动给定的起道信号为负值时，主要用于做下凹的线路，相当于将前张紧小车位置降低，实际上并未降低", o:["对","错"], a:"A"},
    {t:3, q:"14. 捣固车拨道电路中，拨道伺服阀的电流最大可达500mA", o:["对","错"], a:"B"},
    {t:3, q:"15. 捣固车捣固装置升降控制系统是一个包括电路、液压部件和传感器组成的开环控制系统。", o:["对","错"], a:"B"},
    {t:3, q:"1. 人员密集场所应建立防火巡查、防火检查制度，确定巡查、检查的人员、内容、部位和频次。", o:["对","错"], a:"A"},
    {t:3, q:"2. 防火巡查时发现火灾，应立即启动单位灭火和应急疏散预案。", o:["对","错"], a:"B"},
    {t:3, q:"3. 需要经常保持开启状态的防火门，应采用常开式防火门，设置自动和手动关闭装置，并保证其火灾时能自动关闭。", o:["对","错"], a:"A"},

    // --- Page 12 ---
    {t:3, q:"4. 客房内应设置醒目、耐久的“请勿卧床吸烟”提示牌和楼层安全疏散及客房所在位置示意图。", o:["对","错"], a:"A"},
    {t:3, q:"5. 电动车应在指定安全地点停放、充电，禁止在建筑物首层门厅、共用走道、楼梯间、楼道等共用部位，以及疏散通道、安全出口、消防车通道及其两侧影响通行的区域、人员密集场所的室内区域停放或充电。", o:["对","错"], a:"A"},
    {t:3, q:"6. 进行电焊、气割等具有火灾危险作业的人员必须持证上岗，并遵守消防安全操作规程。", o:["对","错"], a:"A"},
    {t:3, q:"7. 有用火、用电、用油、用气的场所或设备在不使用状态时，应熄火断电关", o:["对","错"], a:"A"},
    {t:3, q:"8. 可以在办公、生产、休息场所内乱扔烟蒂等火种。", o:["对","错"], a:"B"},
    {t:3, q:"9. 工程宿营车、工务机械车内可以吸烟和使用明火，严禁私拉乱接电源电线，严禁违章使用电热器具。", o:["对","错"], a:"B"},
    {t:3, q:"10. 工务机械车在站（场）内或专用线停留时，每日不超过24小时对车辆进行一次消防安全检查；", o:["对","错"], a:"B"},
    {t:3, q:"11. 工务机械车驾驶室内及材料小车上严禁存放易燃易爆物品（油脂、纸箱、木箱等）；严禁使用明火；油脂、棉布(纱)要存放在有盖的木质容器内，", o:["对","错"], a:"B"},
    {t:3, q:"12. 基地留（巡）守人员每2小时对基地内的重点部位进行一次全面检查，并做好检查、整改记录。", o:["对","错"], a:"B"},
    {t:3, q:"13. 加油作业地点应选择僻静、空旷场地，尽量选择人多闹杂、建筑物较多及周围易燃物品（杂物）较多的场所。", o:["对","错"], a:"B"},
    {t:3, q:"14. 加油作业时，必须由配送燃油部门（油罐车）专业人员操作，车组作业人员严禁操作加油枪进行加油作业。", o:["对","错"], a:"A"},
    {t:3, q:"15. 严禁使用塑料桶、橡胶桶及其他不符合标准的容器充装燃油。", o:["对","错"], a:"A"},
    {t:3, q:"16. 本务司机不熟悉运行区段的有关行车规定或线路、 信号设备时应安排熟悉运行区段相关情况的司机带道或组织本务司机提前看道", o:["对","错"], a:"A"},
    {t:3, q:"17. 2.机须严格执行一次出乘、 呼唤应答和车机联控等作业标准规范操纵轨道作业车。", o:["对","错"], a:"A"},
    {t:3, q:"18. 3.出乘前24h内休息时间不得少于 6h；在0：00—8：00之间值乘的，出乘前12h内待乘休息不少于4h", o:["对","错"], a:"B"},
    {t:3, q:"19. 自轮运转设备司机出勤按规定统一着装，保持良好的精神状态", o:["对","错"], a:"A"},
    {t:3, q:"20. 临时接收（包括遇有抢险、救援、抢修、施工等临时任务）车站交付的调度命令，任务结束后，及时在临时调度命令明显位置标注“临时”和司机姓名交回车间存档。", o:["对","错"], a:"A"},
    {t:3, q:"21. 自轮运转设备在进入坡度20‰及以上的区段作业时，应两台及以上推挽运", o:["对","错"], a:"A"},
    {t:3, q:"22. 轨道作业车司机连续值乘2个夜班以上的，应调整配班", o:["对","错"], a:"B"},
    {t:3, q:"23. 运行揭示数据文件必须由段、车间使用模拟运行测试设备进行模拟验证后", o:["对","错"], a:"A"},
    {t:3, q:"24. 上线运行前，应根据线路坡度、坡长进行合理编组，原则上各车制动型式原则上相同，并保证车组操纵端具有良好的暸望条件", o:["对","错"], a:"B"},

    // --- Page 13 ---
    {t:3, q:"1. 制动机类型按标准进行试验情况，JZ-1、DK-1、YZ-7型制动机按照五步闸试验方法与项目进行试验", o:["对","错"], a:"B"},
    {t:3, q:"2. 进入停有机车车辆线路的道岔后，应根据停留车位置，正确掌握速度，最高速度不得超过15 km/h", o:["对","错"], a:"B"},
    {t:3, q:"3. 自轮运转设备上线运行时，GYK、视频监控装置以及轴温监测装置（含车轴轴箱、车轴齿轮箱以及踏面温度监测装置）须保持状态良好，全程开", o:["对","错"], a:"A"},
    {t:3, q:"4. 在空线上牵引运行时，不准超过30 km/h；推进运行时，不准超过20 km/h；接近被连挂的作业车时，不准超过5 km/h", o:["对","错"], a:"B"},
    {t:3, q:"5. 调车模式转换（调车信号开放后，本务机为相应调车模式，补机为调车模", o:["对","错"], a:"B"}
];

// --- 逻辑处理 ---
let currIdx = 0;
let userAns = new Array(db.length).fill(null);
let ansState = new Array(db.length).fill(0); // 0:未答 1:对 2:错
let tempSelect = [];

const els = {
    qTag: document.getElementById('qTag'),
    qIdx: document.getElementById('qIdx'),
    qText: document.getElementById('qText'),
    optBox: document.getElementById('optBox'),
    analysis: document.getElementById('analysis'),
    rightAns: document.getElementById('rightAns'),
    subBtn: document.getElementById('subBtn'),
    sheetBox: document.getElementById('sheetBox'),
    sheetModal: document.getElementById('sheetModal'),
    curNum: document.getElementById('curNum'),
    totalNum: document.getElementById('totalNum')
};

function init() {
    els.totalNum.innerText = db.length;
    renderQ();
    renderSheet();
}

function renderQ() {
    const q = db[currIdx];
    const done = ansState[currIdx] !== 0;
    
    // 更新元数据
    els.curNum.innerText = currIdx + 1;
    els.qIdx.innerText = currIdx + 1;
    els.qTag.innerText = q.t === 1 ? '单选' : (q.t === 2 ? '多选' : '判断');
    els.qTag.className = `tag ${q.t === 2 ? 'multi' : (q.t === 3 ? 'judge' : 'single')}`;
    els.qText.innerText = q.q;
    
    // 渲染选项
    els.optBox.innerHTML = '';
    tempSelect = [];
    
    q.o.forEach((opt, i) => {
        const key = String.fromCharCode(65 + i);
        const div = document.createElement('div');
        div.className = 'opt';
        div.onclick = () => handleInput(key, i);
        
        // 回显状态
        if (done) {
            if (q.t === 2) { // 多选回显
                if (q.a.includes(key)) div.classList.add('correct');
                if (userAns[currIdx].includes(key) && !q.a.includes(key)) div.classList.add('wrong');
            } else { // 单选/判断回显
                if (key === q.a) div.classList.add('correct');
                else if (userAns[currIdx] === key) div.classList.add('wrong');
            }
        }
        
        div.innerHTML = `
            <div class="opt-key">${key}</div>
            <div class="opt-text">${opt}</div>
        `;
        els.optBox.appendChild(div);
    });

    // 底部状态
    if (q.t === 2 && !done) {
        els.subBtn.style.display = 'block';
        els.analysis.classList.remove('show');
    } else {
        els.subBtn.style.display = 'none';
        if (done) {
            els.rightAns.innerText = q.a;
            els.analysis.classList.add('show');
        } else {
            els.analysis.classList.remove('show');
        }
    }
}

function handleInput(key, idx) {
    if (ansState[currIdx] !== 0) return;
    const q = db[currIdx];

    if (q.t === 2) { // 多选
        const el = els.optBox.children[idx];
        if (tempSelect.includes(key)) {
            tempSelect = tempSelect.filter(k => k !== key);
            el.classList.remove('selected');
        } else {
            tempSelect.push(key);
            el.classList.add('selected');
        }
    } else { // 单选/判断直接提交
        submitSingle(key);
    }
}

function submitSingle(key) {
    const q = db[currIdx];
    userAns[currIdx] = key;
    const isRight = key === q.a;
    ansState[currIdx] = isRight ? 1 : 2;
    updateSheetItem(currIdx);
    renderQ();
}

function submitMulti() {
    if (tempSelect.length === 0) return alert("请至少选择一个选项");
    const q = db[currIdx];
    const myAns = tempSelect.sort().join('');
    userAns[currIdx] = myAns;
    const isRight = myAns === q.a;
    ansState[currIdx] = isRight ? 1 : 2;
    updateSheetItem(currIdx);
    renderQ();
}

function changeQ(step) {
    const next = currIdx + step;
    if (next >= 0 && next < db.length) {
        currIdx = next;
        renderQ();
        highlightSheetCurr();
    } else {
        alert(step > 0 ? "已经是最后一题了" : "已经是第一题了");
    }
}

// --- 答题卡 ---
function renderSheet() {
    els.sheetBox.innerHTML = '';
    db.forEach((_, i) => {
        const div = document.createElement('div');
        div.className = 'grid-item';
        div.innerText = i + 1;
        div.id = 'sheet-' + i;
        div.onclick = () => {
            currIdx = i;
            renderQ();
            toggleSheet();
            highlightSheetCurr();
        };
        els.sheetBox.appendChild(div);
    });
    highlightSheetCurr();
}

function updateSheetItem(i) {
    const el = document.getElementById('sheet-' + i);
    const s = ansState[i];
    el.className = `grid-item ${s===1 ? 'ok' : 'err'}`;
    if (i === currIdx) el.classList.add('curr');
}

function highlightSheetCurr() {
    Array.from(els.sheetBox.children).forEach(el => el.classList.remove('curr'));
    document.getElementById('sheet-' + currIdx)?.classList.add('curr');
}

function toggleSheet() {
    const show = els.sheetModal.style.display === 'block';
    els.sheetModal.style.display = show ? 'none' : 'block';
}

init();
</script>
</body>
</html>